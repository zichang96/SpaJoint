# SpaJoint
[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.15230712.svg)](https://doi.org/10.5281/zenodo.15230712)

SpaJoint: a transfer learning method for spatial transcriptomics deconvolution.\
SpaJoint is a transfer learning method that integrates gene expression derived from single-cell RNA sequencing (scRNA-seq) and spatial transcriptomics with the spatial correlation across different tissue locations. 
# Installation
1. clone repository
```
git clone https://github.com/zichang96/SpaJoint.git
cd SpaJoint/
```
2. create environment
```
conda create -n SpaJoint python=3.8.10
conda activate SpaJoint
```
3. install pytorch
```
conda install pytorch==1.10.1 torchvision==0.11.2 torchaudio==0.10.1 cudatoolkit=10.2 -c pytorch
```
4. install other dependencies
```
pip install numpy==1.22.3 pandas==2.0.3 scanpy==1.9.8 scipy==1.10.1 squidpy==1.2.3 tqdm==4.66.5 h5py==3.11.0 scikit-misc==0.2.0
```
# Data preparation
Several paired scRNA-seq and ST datasets have been prepared as the input of SpaJoint model. These datasets can be downloaded from the [Google Drive](https://drive.google.com/drive/folders/1RQKKQWv3ZkRbItMoOhQ3gwOwsbb5obd9?usp=drive_link). Each dataset will have its own subfolder in data folder. Each dataset will contain two major files, which denote scRNA-seq data (scRNA.h5ad) and ST data (ST.h5ad), respectively. For mouse visual cortex dataset, there also have ground truth information (combined_spot_clusters.txt) and spatial spot location (combined_Locations.txt).
# Tutorials
A step-by-step tutorial using scRNA-seq and ST  example data ([link](https://github.com/zichang96/SpaJoint/tree/main/example)) which were generated by selecting highly variable genes and randomly sampling 512 cells and spots respectively from the original human breast cancer data is demonstrated here: ([link](https://github.com/zichang96/SpaJoint/blob/main/tutorial%20for%20example%20data.ipynb)).
Code for generating the figures of our paper is located here ([link](https://github.com/zichang96/SpaJoint/blob/main/tutorial%20for%20real%20data.ipynb)). The data can be downloaded from the [Google Drive](https://drive.google.com/drive/folders/1RQKKQWv3ZkRbItMoOhQ3gwOwsbb5obd9?usp=drive_link) in data folder and human_breast_cancer subfolder.
# Contact
Also Feel free to open an issue in Github or contact lizch0214@ruc.edu.cn if you have any problem in running SpaJoint.
# License
This project is licensed under the MIT License - see the LICENSE.md file for details.
